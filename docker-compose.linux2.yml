version: '3.8'

# Linux 2 Configuration: Web + Monitor Ollama Agent
# Monitor Ollama connects to DB on Linux 1 (LINUX_1_IP:5432)

services:
  monitor-ollama:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: aat-monitor-ollama
    command: python agents/monitor_ollama_server.py
    environment:
      - DB_HOST=${LINUX_1_IP:-128.140.108.240}
      - DB_PORT=5432
      - DB_NAME=trading
      - DB_USER=${DB_USER}
      - DB_PASS=${DB_PASS}
      - OLLAMA_BASE_URL=${OLLAMA_BASE_URL:-http://168.119.122.36:11434}
      - OLLAMA_MOD_VERSION=v0.5
    restart: unless-stopped
    networks:
      - aat-network

networks:
  aat-network:
    driver: bridge
