version: '3.8'

# ====================================================================
# LINUX 1 Configuration: All Agents (except monitor-ollama)
# ====================================================================
# - Monitor DB: monitors TimescaleDB on localhost:5432
# - Future agents: embedding, matching, trace, git-impact, etc.
# - All connect to local TimescaleDB
# ====================================================================

services:
  # Monitor DB Agent
  monitor-db:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: aat-monitor-db
    command: python agents/monitor_db_server.py
    restart: unless-stopped
    environment:
      # Database connection to localhost (DB is on same server)
      - DB_HOST=${DB_HOST:-localhost}
      - DB_PORT=${DB_PORT:-5432}
      - DB_NAME=${DB_NAME:-trading}
      - DB_USER=${DB_USER}
      - DB_PASS=${DB_PASS}
    network_mode: "host"

  # Future agents can be added here:
  # embedding-agent:
  #   ...
  # matching-agent:
  #   ...
  # trace-agent:
  #   ...
  # git-impact-agent:
  #   ...
